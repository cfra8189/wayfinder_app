const express = require('express');
const path = require('path');
const app = express();
const port = 5100;

app.use(express.json());
app.use(express.static(path.join(__dirname, 'public')));

app.post('/api/generate-agreement', (req, res) => {
    const { name, type, collaboratorName, collaboratorEmail } = req.body;

    if (!name || !type || !collaboratorName || !collaboratorEmail) {
        return res.status(400).json({ success: false, message: 'All fields are required.' });
    }

    let agreementText = '';
    const agreementDate = new Date().toLocaleDateString('en-US');

    switch (type) {
        case 'basic-license':
            agreementText = `### 1. Basic Non-Exclusive License Agreement\n**Agreement ID Format:** PX-01-NE-BASIC-${Date.now()}\n**Fee:** $50 USD\n**Usage Limit:** 50,000 streams/sales\n**Deliverables:** MP3 file only\n\n**What You Get:**\n- Worldwide rights to use the beat for one song, identified as Project "${name.toUpperCase()}."\n- Up to 50,000 total streams/sales across all platforms\n- One official music video allowed\n- Distribution rights (digital only, up to 500 physical copies)\n\n**What I Keep:**\n- 50% of publishing royalties\n- 20% of master recording royalties\n- Right to license the same beat to other artists\n\n**Your Responsibilities:**\n- Credit me as "Produced by LUCTHELEO" on all releases\n- Send royalty statements every 6 months\n- Upgrade to Standard License if you exceed 50,000 streams/sales\n\n**Important Notes:**\n- No sync rights (TV, film, commercials) included\n- License activates only after full payment\n- Exceeding limits without upgrading violates this agreement\nThis agreement is between the producer LUCTHELEO and the collaborator **${collaboratorName.toUpperCase()}** (Email: ${collaboratorEmail}).`;
            break;

        case 'standard-license':
            agreementText = `### 2. Standard Non-Exclusive License Agreement\n**Fee:** $100 USD\n**Usage Limit:** 100,000 streams/sales\n**Deliverables:** MP3 + WAV files\n\n**What You Get:**\n- Worldwide rights to use the beat for one song, identified as Project "${name.toUpperCase()}."\n- Up to 100,000 total streams/sales across all platforms\n- One official music video allowed\n- Distribution rights (digital and up to 1,000 physical copies)\n\n**What I Keep:**\n- 50% of publishing royalties\n- 20% of master recording royalties\n- Right to license the same beat to other artists\n\n**Your Responsibilities:**\n- Credit me as "Produced by LUCTHELEO" on all releases\n- Send royalty statements every 6 months\n- Upgrade to Premium License if you exceed 100,000 streams/sales\n\n**Important Notes:**\n- No sync rights (TV, film, commercials) included\n- License activates only after full payment\n- Exceeding limits without upgrading violates this agreement\nThis agreement is between the producer LUCTHELEO and the collaborator **${collaboratorName.toUpperCase()}** (Email: ${collaboratorEmail}).`;
            break;

        case 'premium-license':
            agreementText = `### 3. Premium Non-Exclusive License Agreement\n**Fee:** $175 USD\n**Usage:** Unlimited streams/sales\n**Deliverables:** MP3 + WAV + Stems\n\n**What You Get:**\n- Worldwide rights to use the beat for one song, identified as Project "${name.toUpperCase()}."\n- Unlimited streams, sales, and performances\n- Multiple music videos allowed\n- Distribution rights (digital and physical)\n- Basic sync rights for independent projects\n\n**What I Keep:**\n- 50% of publishing royalties\n- 20% of master recording royalties\n- Right to license the same beat to other artists\n\n**Your Responsibilities:**\n- Credit me as "Produced by LUCTHELEO" on all releases\n- Send royalty statements every 6 months\n- Notify me within 30 days of any major sync placements\n\n**Important Notes:**\n- Major sync deals (film/TV/commercials) require separate negotiation\n- I receive backend participation on major sync placements\n- License activates only after full payment\nThis agreement is between the producer LUCTHELEO and the collaborator **${collaboratorName.toUpperCase()}** (Email: ${collaboratorEmail}).`;
            break;

        case 'exclusive-license':
            agreementText = `### 4. Exclusive License Agreement\n**Fee:** Varies by beat (see individual beat pricing)\n**Usage:** Unlimited with full exclusivity\n**Deliverables:** MP3 + WAV + Stems + Project Files\n\n**What You Get:**\n- Exclusive worldwide rights to the beat\n- Unlimited streams, sales, and performances\n- Multiple music videos allowed\n- Full sync rights for all media (film, TV, commercials, games)\n- Complete stems and project files\n- I stop licensing the beat to anyone else\n\n**What I Keep:**\n- 50% of publishing royalties\n- Variable master recording royalties (see individual beat terms)\n- 3% of gross revenue from all exploitations\n\n**Your Responsibilities:**\n- Credit me as "Produced by LUCTHELEO" on all releases\n- Send royalty statements every 6 months\n- Cannot resell or re-license the beat to others\n\n**Important Notes:**\n- Payment due in full before beat delivery\n- Agreement is permanent unless terminated for breach\n- All sync rights included - no additional fees needed\nThis agreement is between the producer LUCTHELEO and the collaborator **${collaboratorName.toUpperCase()}** (Email: ${collaboratorEmail}).`;
            break;

        case 'full-buyout':
            agreementText = `### 5. Full Buyout Agreement\n**Fee:** Varies by beat (see individual beat pricing)\n**Usage:** Complete ownership transfer\n\n**What You Get:**\n- 100% ownership of the beat\n- All publishing and master recording rights\n- No ongoing royalty payments to me\n- Right to resell or re-license the beat\n- Complete creative and financial control\n\n**What I Give Up:**\n- All future royalties and publishing\n- All rights to the beat\n- Ability to license the beat to others\n\n**Requirements:**\n- Must have existing Exclusive License Agreement first\n- Full buyout payment due before ownership transfer\n- All paperwork and copyright transfers completed\n\n**Important Notes:**\n- This is permanent - cannot be reversed\n- Highest tier of beat ownership available\n- Recommended only for major releases or label projects\nThis agreement is between the producer LUCTHELEO and the collaborator **${collaboratorName.toUpperCase()}** (Email: ${collaboratorEmail}).`;
            break;

        case 'custom-production':
            agreementText = `### 6. Custom Production Agreement\n**Base Rate:** $500-2,000 per track (depending on scope)\n**Timeline:** 2-4 weeks from start to completion\n\n**Services Included:**\n- Custom beat creation from scratch for Project "${name.toUpperCase()}."\n- Full production (arrangement, mixing, mastering)\n- Unlimited revisions during production phase\n- Complete project files and stems delivery\n- Producer credit and standard royalty split\n\n**What I Need From You:**\n- Reference tracks showing desired style/sound\n- Complete vocal recordings (if applicable)\n- Clear creative direction and timeline\n- 50% deposit to begin work\n\n**Royalty Structure:**\n- 50% publishing royalties\n- 10% master recording royalties\n- 3% of gross revenue from all exploitations\n\n**Process:**\n1. Mandatory consultation to discuss vision\n2. Deposit payment and contract signing\n3. Initial production and first draft delivery\n4. Revision rounds until satisfaction\n5. Final delivery with all files\nThis agreement is between the producer LUCTHELEO and the collaborator **${collaboratorName.toUpperCase()}** (Email: ${collaboratorEmail}).`;
            break;

        case 'coaching-services':
            agreementText = `### 7. Creative Development Coaching\n**Individual Sessions:** $75 per hour\n**Package Deal:** $500 for 8 hours (save $100)\n\n**What's Covered:**\n- Song structure and arrangement fundamentals\n- Music theory basics for practical application\n- Recording techniques and studio workflow\n- Creative development and artistic direction\n- Industry knowledge and business basics\n\n**Who This Is For:**\n- Artists lacking music theory knowledge\n- Collaborators needing song structure guidance\n- Anyone wanting to improve their creative process\n- Artists preparing for professional production\n\n**Session Format:**\n- One-on-one sessions (in-person or virtual)\n- Customized curriculum based on your needs\n- Homework assignments and practice materials\n- Progress tracking and skill development\n\n**Important Notes:**\n- Coaching is optional but recommended for complex projects\n- Can be combined with production services\n- Builds foundation for future independent work\n- Investment in your long-term creative growth\nThis agreement is between the producer LUCTHELEO and the collaborator **${collaboratorName.toUpperCase()}** (Email: ${collaboratorEmail}).`;
            break;

        default:
            return res.status(400).json({ success: false, message: 'Invalid agreement type.' });
    }

    agreementText += `\n\n---\n**CONFIDENTIAL AND SEALED**\n**Date/Time:** ${agreementDate}, ${new Date().toLocaleTimeString()}\n**Producer Signature:** LUCTHELEO\n\n**Collabrator Signature:** ${collaboratorName.toUpperCase()}\n\n**END OF AGREEMENT**\n`;

    res.json({ success: true, agreement: agreementText });
});

app.listen(port, () => console.log(`Demo server running on http://localhost:${port}`));
